// ==========================================================================
// Project:   Ember Validations
// Copyright: Â© 2013 DockYar, LLC. and contributors.
// License:   Licensed under MIT license (see license.js)
// ==========================================================================


// Last commit: 213e1cf (2013-06-04 08:04:20 -0700)


!function(){Ember.Validations=Ember.Namespace.create({VERSION:"0.2.1"})}(),function(){Ember.Application.reopen({bootstrapValidations:function(e){function s(e){var t,a,n={};for(t in e)a="object"==typeof e[t]?s(e[t]):e[t],n[t.camelize()]=a;return n}var t,a,n={};for(t in e)a=(new(this[t.camelize().capitalize()])).get("validations"),n=s(e[t]),this[t.camelize().capitalize()].reopen({validations:Ember.$.extend(!0,{},n,a)})}})}(),function(){Ember.Validations.messages={render:function(e,s){return Handlebars.compile(Ember.Validations.messages.defaults[e])(s)},defaults:{inclusion:"is not included in the list",exclusion:"is reserved",invalid:"is invalid",confirmation:"doesn't match {{attribute}}",accepted:"must be accepted",empty:"can't be empty",blank:"can't be blank",present:"must be blank",tooLong:"is too long (maximum is {{count}} characters)",tooShort:"is too short (minimum is {{count}} characters)",wrongLength:"is the wrong length (should be {{count}} characters)",notANumber:"is not a number",notAnInteger:"must be an integer",greaterThan:"must be greater than {{count}}",greaterThanOrEqualTo:"must be greater than or equal to {{count}}",equalTo:"must be equal to {{count}}",lessThan:"must be less than {{count}}",lessThanOrEqualTo:"must be less than or equal to {{count}}",otherThan:"must be other than {{count}}",odd:"must be odd",even:"must be even"}}}(),function(){Ember.Validations.Errors=Ember.Object.extend({add:function(e,s){this.set(e,(this.get(e)||[]).concat(s))},clear:function(){var e=Object.keys(this),s=null;arguments.length>1?s=Array.prototype.slice.apply(arguments):1===arguments.length&&(s=arguments[0]instanceof Array?arguments[0]:[arguments[0]]);for(var t=0;t<e.length;t++)s&&s.indexOf(e[t])<0||(this.set(e[t],void 0),delete this[e[t]])}})}(),function(){Ember.Validations.Mixin=Ember.Mixin.create({init:function(){this._super(),this.set("errors",Ember.Validations.Errors.create()),void 0===this.get("validations")&&this.set("validations",{})},validate:function(e){var s,t,a,n,r,i,o=[],l=this,d=function(e,s){if("object"!=typeof e)return!0;if(e["if"]){if("function"==typeof e["if"])return e["if"](l,s);if("string"==typeof e["if"])return"function"==typeof l[e["if"]]?l[e["if"]]():l.get(e["if"])}else{if(!e.unless)return!0;if("function"==typeof e.unless)return!e.unless(l,s);if("string"==typeof e.unless)return"function"==typeof l[e.unless]?!l[e.unless]():!l.get(e.unless)}};for(a=void 0!==e?[e]:Object.keys(l.validations),r=0;r<a.length;r++){s=a[r],this.errors.set(s,void 0),delete this.errors[s];for(t in l.validations[s])for(n=l.validations[s][t],("object"!=typeof n||"object"==typeof n&&n.constructor!==Array)&&(n=[n]),i=0;i<n.length;i++)if(d(n[i],t)){var m=new Ember.Deferred;o=o.concat(m),Ember.isNone(Ember.Validations.validators.local[t])?Ember.isNone(Ember.Validations.validators.remote[t])||Ember.Validations.validators.remote[t](l,s,n[i],m):Ember.Validations.validators.local[t](l,s,n[i],m)}}return Ember.RSVP.all(o).then(function(){l.get("stateManager")?0===Object.keys(l.errors).length?l.get("isDirty")&&l.get("stateManager").transitionTo("uncommitted"):l.get("stateManager").transitionTo("invalid"):l.set("isValid",0===Object.keys(l.errors).length)})}})}(),function(){Ember.Validations.patterns=Ember.Namespace.create({numericality:/^(-|\+)?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d*)?$/,blank:/^\s*$/})}(),function(){Ember.Validations.validators=Ember.Namespace.create(),Ember.Validations.validators.local=Ember.Namespace.create(),Ember.Validations.validators.remote=Ember.Namespace.create()}(),function(){Ember.Validations.validators.local.reopen({absence:function(e,s,t,a){t===!0&&(t={}),void 0===t.message&&(t.message=Ember.Validations.messages.render("present",t)),Ember.Validations.Utilities.isBlank(e.get(s))||e.errors.add(s,t.message),a&&a.resolve()}})}(),function(){Ember.Validations.validators.local.reopen({acceptance:function(e,s,t,a){t===!0&&(t={}),void 0===t.message&&(t.message=Ember.Validations.messages.render("accepted",t)),t.accept?e.get(s)!==t.accept&&e.errors.add(s,t.message):"1"!==e.get(s)&&1!==e.get(s)&&e.get(s)!==!0&&e.errors.add(s,t.message),a&&a.resolve()}})}(),function(){Ember.Validations.validators.local.reopen({confirmation:function(e,s,t,a){t===!0&&(t={attribute:s},t={message:Ember.Validations.messages.render("confirmation",t)}),e.get(s)!==e.get(""+s+"Confirmation")&&e.errors.add(s,t.message),a&&a.resolve()}})}(),function(){Ember.Validations.validators.local.reopen({exclusion:function(e,s,t,a){var n,r;t.constructor===Array&&(t={"in":t}),void 0===t.message&&(t.message=Ember.Validations.messages.render("exclusion",t)),Ember.Validations.Utilities.isBlank(e.get(s))?void 0===t.allowBlank&&e.errors.add(s,t.message):t["in"]?-1!==Ember.$.inArray(e.get(s),t["in"])&&e.errors.add(s,t.message):t.range&&(n=t.range[0],r=t.range[1],e.get(s)>=n&&e.get(s)<=r&&e.errors.add(s,t.message)),a&&a.resolve()}})}(),function(){Ember.Validations.validators.local.reopen({format:function(e,s,t,a){t.constructor===RegExp&&(t={"with":t}),void 0===t.message&&(t.message=Ember.Validations.messages.render("invalid",t)),Ember.Validations.Utilities.isBlank(e.get(s))?void 0===t.allowBlank&&e.errors.add(s,t.message):t["with"]&&!t["with"].test(e.get(s))?e.errors.add(s,t.message):t.without&&t.without.test(e.get(s))&&e.errors.add(s,t.message),a&&a.resolve()}})}(),function(){Ember.Validations.validators.local.reopen({inclusion:function(e,s,t,a){var n,r;t.constructor===Array&&(t={"in":t}),void 0===t.message&&(t.message=Ember.Validations.messages.render("inclusion",t)),Ember.Validations.Utilities.isBlank(e.get(s))?void 0===t.allowBlank&&e.errors.add(s,t.message):t["in"]?-1===Ember.$.inArray(e.get(s),t["in"])&&e.errors.add(s,t.message):t.range&&(n=t.range[0],r=t.range[1],(e.get(s)<n||e.get(s)>r)&&e.errors.add(s,t.message)),a&&a.resolve()}})}(),function(){Ember.Validations.validators.local.reopen({length:function(e,s,t,a){var n,r,i,o,l,d,m,c,g,u,b;for(n={is:"==",minimum:">=",maximum:"<="},r={is:"wrongLength",minimum:"tooShort",maximum:"tooLong"},"number"==typeof t&&(t={is:t}),void 0===t.messages&&(t.messages={}),u=Object.keys(r),g=0;g<u.length;g++)b=u[g],void 0!==t[b]&&void 0===t.messages[r[b]]&&(-1!==Ember.$.inArray(b,Object.keys(n))&&(t.count=t[b]),t.messages[r[b]]=Ember.Validations.messages.render(r[b],t),void 0!==t.count&&delete t.count);if(c=t.tokenizer||'split("")',m=new Function("value","return value."+c+".length")(e.get(s)||""),i={},t.is?i.message=t.messages.wrongLength:t.minimum&&(i.message=t.messages.tooShort),Ember.Validations.Utilities.isBlank(e.get(s)))void 0===t.allowBlank&&(t.is||t.minimum)&&e.errors.add(s,i.message);else for(o in n)d=n[o],t[o]&&(l=new Function("return "+m+" "+d+" "+t[o]),l()||e.errors.add(s,t.messages[r[o]]));a&&a.resolve()}})}(),function(){Ember.Validations.validators.local.reopen({numericality:function(e,s,t,a){var n,r,i,o,l,d,m,c;for(n={equalTo:"===",greaterThan:">",greaterThanOrEqualTo:">=",lessThan:"<",lessThanOrEqualTo:"<="},t===!0&&(t={}),void 0===t.messages&&(t.messages={numericality:Ember.Validations.messages.render("notANumber",t)}),void 0!==t.onlyInteger&&void 0===t.messages.onlyInteger&&(t.messages.onlyInteger=Ember.Validations.messages.render("notAnInteger",t)),m=Object.keys(n).concat(["odd","even"]),d=0;d<m.length;d++)c=m[d],void 0!==t[c]&&void 0===t.messages[c]&&(-1!==Ember.$.inArray(c,Object.keys(n))&&(t.count=t[c]),t.messages[c]=Ember.Validations.messages.render(c,t),void 0!==t.count&&delete t.count);if(Ember.Validations.Utilities.isBlank(e.get(s)))void 0===t.allowBlank&&e.errors.add(s,t.messages.numericality);else if(Ember.Validations.patterns.numericality.test(e.get(s)))if(t.onlyInteger!==!0||/^[+\-]?\d+$/.test(e.get(s))){if(t.odd&&0===parseInt(e.get(s),10)%2)e.errors.add(s,t.messages.odd);else if(t.even&&0!==parseInt(e.get(s),10)%2)e.errors.add(s,t.messages.even);else for(r in n)if(l=n[r],void 0!==t[r]){if(!isNaN(parseFloat(t[r]))&&isFinite(t[r]))i=t[r];else{if(void 0===e.get(t[r]))return a&&a.resolve(),void 0;i=e.get(t[r])}o=new Function("return "+e.get(s)+" "+l+" "+i),o()||e.errors.add(s,t.messages[r])}}else e.errors.add(s,t.messages.onlyInteger);else e.errors.add(s,t.messages.numericality);a&&a.resolve()}})}(),function(){Ember.Validations.validators.local.reopen({presence:function(e,s,t,a){t===!0&&(t={}),void 0===t.message&&(t.message=Ember.Validations.messages.render("blank",t)),Ember.Validations.Utilities.isBlank(e.get(s))&&e.errors.add(s,t.message),a&&a.resolve()}})}(),function(){Ember.Validations.Utilities={isBlank:function(e){return 0!==e&&(!e||/^\s*$/.test(""+e))}}}(),"undefined"==typeof location||"localhost"!==location.hostname&&"127.0.0.1"!==location.hostname||Ember.Logger.warn("You are running a production build of Ember on localhost and won't receive detailed error messages. If you want full error messages please use the non-minified build provided on the Ember website.");